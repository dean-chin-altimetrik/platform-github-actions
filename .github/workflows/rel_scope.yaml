name: REL-SCOPE check
on:
  workflow_dispatch:
    inputs:
      jira_key:
        description: "Jira issue key (e.g., REL-1234)"
        required: true
        type: string
      component:
        description: "Component"
        required: true
        type: string
      branch_name:
        description: "Branch Name"
        required: true
        type: string

jobs:
  check:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      # Call the composite action from this repository so the runner fetches it
      # into GITHUB_ACTION_PATH (callers don't need to checkout workspace code).
      - name: Check REL-SCOPE in Jira
        id: rel
        uses: dean-chin-altimetrik/platform-github-actions/.github/actions/jira-rel-scope@main
        with:
          jira_key: ${{ inputs.jira_key }}
          component: ${{ inputs.component }}
          branch_name: ${{ inputs.branch_name }}
        env:
          # Provide these as repo/org secrets
          JIRA_BASE_URL: ${{ secrets.JIRA_BASE_URL }}   # e.g. https://yourorg.atlassian.net
          JIRA_EMAIL:    ${{ secrets.JIRA_EMAIL }}
          JIRA_API_TOKEN: ${{ secrets.JIRA_API_TOKEN }}

      - name: Echo outputs (example)
        run: |
          echo "is_rel_scope: ${{ steps.rel.outputs.is_rel_scope }}"
          echo "has_description: ${{ steps.rel.outputs.has_description }}"
          echo "has_table: ${{ steps.rel.outputs.has_table }}"
          echo "matched_rows_json: ${{ steps.rel.outputs.matched_rows_json }}"
